# 体系结构文档

## 文档说明

### 1  目的

本文档是 Prompt Injection Attack Evaluation 系统即 PiaEval 系统的体系结构文档，描述了该系统的体系结构设计。

本文档的目的是帮助开发人员设计和理解 PiaEval 系统的体系结构，提高开发效率和优化开发流程。

本文档基于需求文档编写，指导系统设计和代码编写，具有承上启下的作用。

### 2  词汇表

| EN Abbr        | English Full Name                         | 中文全称             | 中文简称     | 备注 |
| -------------- | ----------------------------------------- | -------------------- | ------------ | ---- |
| PiaEval System | Prompt Injection Attack Evaluation System | 提示注入攻击评估系统 | Pia 评估系统 | /    |
| LLM            | Large Language Model                      | 大语言模型           | /            | /    |
| PIA            | Prompt Injection Attack                   | 提示注入攻击         | /            | /    |

### 3  参考文献

## 系统说明

### 1  产品背景

随着自然语言处理 NLP 技术的发展和 Transformer 架构的出现，大语言模型 LLM 在计算机领域得到了快速发展。从 Google 的 Bert 和 OpenAI 的 ChatGPT 开始，涌现了许多 LLM 开发企业及其开发的 LLM 系统，如 LLaMa、Claude、Qwen、DeepSeek。LLM 不仅在学术研究上具有广阔的研究前景，在商业市场上也得到了一定的应用，出现了许多投入实际生产的 LLM 驱动系统。

随着 LLM 的迅猛发展，对其进行技术监管和法律监管必须同步进行。法律监管建立在技术监管的可行性基础之上，技术监管应该满足法律监管的要求。为满足 LLM 的合规性发展，促进 LLM 驱动的系统在商业方面的广泛应用，对 LLM 进行技术监管势在必行。这要求针对 LLM 的不同方面，开发一套可行的技术要求、衡量指标和评估方法，并使它们满足相关法律法规。

然而，当今对于 LLM 的大部分评估方法，只关注 LLM 的能力和性能方面，对于非功能性方面则关注甚少，如安全性、公平性、隐私性等。在非功能性方面的衡量标准和衡量指标都不够完善，因而难以实现相关的基准测试和评估方法。随着 LLM 的商业化越来越正式，市场对于 LLM 的评估要求越来越高，亟需更加成熟的评估方案和评估系统。

### 2  系统概述

本系统全称为 Prompt Injection Attack Evaluation System，即提示注入攻击评估系统，简称为 PiaEval System。本系统关注 LLM 的安全性评估，聚焦于 PIA 方面，旨在提供全方位、多层次、可分析的具有实际意义的自动化评估系统。

本系统希望达到的目的，在评估方面概述为：

- 对 LLM PIA 方面的安全性进行多方面、多层次的分类。
- 对 PIA 评估提供衡量指标、基准测试、自动化评估的一套解决方案。
- 实现自动化评估，使得用户能够轻松完成评估。
- 用户能够自定义个性化评估方案。
- 结果可分析且具有实际意义，并能生成评估报告。

本系统将实现为客户端-服务端系统，客户端使用 Web 界面进行工作，也支持接口调用的方式进行工作。本系统面向 LLM 开发者和法律监管人员进行设计，也考虑到其它用户群体的需求。本系统支持用户模式，允许用户以不同虚拟用户身份使用系统并持久化保存数据，多个客户端和一个服务端进行交互。本系统也考虑优化使用体验，如提供完整的接口文档和技术手册、支持自动化配置、优化 Web 页面等。

## 体系结构设计

### 1  体系结构风格

本系统实现为客户端-服务端系统。服务端部署在服务器上，客户端部署在用户计算机上，多个客户端和一个服务端进行通信。服务端使用 Python 开发，客户端使用 Vue 开发并展示为 Web 页面。

在本文档的其余部分，若无特别说明，则均描述服务端的体系结构设计。

服务端使用分层体系结构作为设计风格，将系统分为四层：展示层、接口层、逻辑层、数据层。系统划分为不同模块，每一模块必定具有接口层和逻辑层，可能具有展示层和数据层。

- 展示层：系统和客户端通信。
- 接口层：提供逻辑层的统一接口，逻辑层可以有不同的内部实现。
- 逻辑层：实现接口层的统一接口，适用于不同需求。
- 数据层：访问逻辑层需要使用的数据。

（图片）

### 2  模块设计

### 2.1  模块划分

系统纵向划分为不同模块，每一模块完成一个特定功能。

模块划分为两个级别，主模块完成某一方面的功能，子模块完成主模块的特定方面的功能。主模块的子模块可以重叠。

| 主模块         | 子模块                                |
| -------------- | ------------------------------------- |
| LLM            | llm, prompt, embedding                |
| Pia Evaluation | metric, benchmark, evaluation, report |
| Others         | base, integration, user               |

每一模块的功能概述如下。

| 模块        | 功能                    |
| ----------- | ----------------------- |
| prompt      | LLM prompt 的构造和生成 |
| embedding   | 文本嵌入                |
| llm         | LLM 交互和响应          |
| metric      | 衡量指标计算            |
| benchmark   | 基准测试                |
| evaluation  | 自动化评估流程          |
| report      | 生成评估报告            |
| base        | 基础工具                |
| integration | 第三方集成              |
| user        | 用户                    |

（图片）

### 2.2  模块依赖

模块之间的依赖关系概述如下。

| 模块        | 依赖模块                           |
| ----------- | ---------------------------------- |
| prompt      | /                                  |
| embedding   | /                                  |
| llm         | prompt, embedding                  |
| metric      | /                                  |
| benchmark   | metric, llm                        |
| evaluation  | benchmark, llm                     |
| report      | evaluation                         |
| base        | /                                  |
| integration | /                                  |
| user        | llm, benchmark, evaluation, report |

（图片）

### 3  模块交互

## 体系结构描述